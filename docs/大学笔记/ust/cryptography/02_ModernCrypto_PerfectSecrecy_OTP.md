## Modern cryptography

Core principles

1. **Formal definitions**：
   - 这包括对安全性的精确数学模型和定义，以及安全性意味着什么的定义。
   - 这种正式定义提供了对密码系统安全性的明确理解。
2. **Assumptions**：
   - 假设是明确陈述且无歧义的。
   - 这些假设可能涉及密码系统的环境、攻击者的能力等方面。
3. **Proofs of security**：
   - 这意味着摆脱了设计-破解-修复循环。
   - 安全性证明是通过数学推导和严格的逻辑推理来证明密码系统的安全性。
   - 它提供了一种在数学上验证密码系统安全性的方法，而不是依赖于实验和试错。



Importance of definitions

- design
- analysis
- usage



Defining secure encryption

## Perfect secrecy

![image-20240510124129758](assets\image-20240510124129758.png)

### 完善保密性Perfect Secrey

如果任意两个明文m0,m1∈M，给定任意一个密文c，每个明文被加密成c的概率时相等的（明文空间中所有明文被加密成该密文的概率是一样的）。

则（E,D）具有完善保密性，其中k属于K是随机的。



**密文不会泄露明文的任何信息**

攻击者窃听到任意一个密文后，该密文到底是加密哪个明文得来的呢？既然每个明文加密成该密文的概率一样，那么攻击者不知道该密文对应哪个明文



**一个对称加密方案是完善保密的，那就是安全的**



**注意事项**

- 唯密文攻击无效（其他类型攻击未必安全）：考虑的是唯密文攻击，也就是攻击者手里只有窃听到的密文（密文不泄露明文信息）
- 任何信息指的是明文内容，不包括明文长度和发送时间

**完整定义**

![image-20240510122608295](assets\image-20240510122608295.png)



**等价定义**

给定任意密文c，对于明文空间中所有明文，如果把每个明文加密成c的密钥数量是相等的，都是N，那么加密方案就算完善保密的

![image-20240510123318449](assets\image-20240510123318449.png)





## One-time pad

### 什么是OTP

明文m，密文c和密钥k都是**长度相等的比特串**（任何message和数字都可以表示成比特串形式），注意密钥是随机的

加密：明文异或密钥得到密文

解密：密文和密钥异或得到明文

![image-20240510135619235](assets\image-20240510135619235.png)

### 一次一密的完善保密性

![image-20240510135832856](assets\image-20240510135832856.png)

![image-20240510135839826](assets\image-20240510135839826.png)

### Security of OTP

The one-time pad is perfectly secret 

### Limitation

One-time pad

一次一密实现了完善保密

曾经应用，但是现在不用了，为什么？



限制：

key和message一样长

只有当每个密钥用于加密单个消息时，才会安全

所以各方必须共享（总）长度等于他们可能发送的所有消息的（总）长度的密钥

### 缺点

密钥和明文一样长

只有当每个密钥被用来加密一次时，才安全

Trivially broken by a known-plaintext attack

### Optimality

定理：如果具有消息空间M的（Gen，Enc，Dec）是完全秘密的，则|K|≥|M|

给定任何密文，尝试在K中的每个可能的密钥下解密

证明

### 改造一次一密

Computational secrecy：



## 04 香农定理

## 补充

### Probability

1. *Random variable*：随机变量是一种可以取（离散）值且具有一定概率的变量。
   - 随机变量的概率分布给出了变量取每个可能值的概率。
   - 每个概率值必须介于0和1之间，且所有概率值的总和必须等于1。
2. **事件**：某个实验中的特定发生。
   - 例如，随机变量X取值为x的事件。
   - 记为Pr[E]，表示事件E发生的概率。
3. **条件概率**：给定某一事件发生的情况下，另一个事件发生的概率。
   - – Pr[A | B] = Pr[A and B]/Pr[B]
4. **独立性**：如果对于所有的x，y，随机变量X和Y独立，则Pr[X=x | Y=y] = Pr[X=x]。
5. **全概率公式**：假设E1，…，En是所有可能性的一个分割。则对于任何A：
   - Pr[A] = Σi Pr[A 和 Ei] = Σi Pr[A | Ei] · Pr[Ei]。

符号表示：

- K（密钥空间）：所有可能密钥的集合。
- C（密文空间）：所有可能的密文的集合。

Probability distributions：

- 让M表示消息的随机变量。
  - M的取值范围为M，取决于上下文！
  - 反映了在给定攻击者先验知识的情况下发送不同消息的可能性。
  - 例如，Pr[M = “attack today”] = 0.7，Pr[M = “don't attack”] = 0.3。
- 让K表示密钥的随机变量。
  - K的取值范围为K。
- 固定某个加密方案（Gen、Enc、Dec）：
  - Gen为K定义了密钥的概率分布：Pr[K = k] = Pr[Gen输出密钥k]。
  - 通常为均匀分布，但并非总是如此。
- 假设随机变量M和K是独立的：
  - 即，参与方不会基于消息选择密钥，或者基于密钥选择消息。
  - 一般情况下，这一假设成立。
  - 如果不成立，可能会引发问题。
- 固定某个加密方案（Gen、Enc、Dec）和某个M的分布：
  - 考虑以下（随机化的）实验：
    1. 使用Gen生成密钥k。
    2. 根据给定的分布选择消息m。
    3. 计算c ¬ Enck(m)。
  - 这定义了密文的分布！
  - 让C表示在此实验中密文的值的随机变量。



案例

![image-20240510120725880](assets\image-20240510120725880.png)

![image-20240510120755225](assets\image-20240510120755225.png)

### Bayes’s theorem

• Pr[A | B] = Pr[B | A] · Pr[A]/Pr[B]

![image-20240510124404821](assets\image-20240510124404821.png)

![image-20240510124411698](assets\image-20240510124411698.png)

![image-20240510124416382](assets\image-20240510124416382.png)